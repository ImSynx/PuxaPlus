{% extends "main_layout.html" %}

{% block title %}Notificações • Puxa+{% endblock %}

{% block page_content %}
  <div class="max-w-3xl mx-auto space-y-6">
    <div class="flex items-center justify-between">
      <h1 class="text-4xl font-bold">Notificações</h1>
      {% if unread_count > 0 %}
        <form method="POST" action="{{ url_for('mark_all_notifications_read') }}" class="inline">
          <button
            type="submit"
            class="bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition-colors text-sm font-semibold"
          >
            Marcar todas como lidas
          </button>
        </form>
      {% endif %}
    </div>

    {% if notifications %}
      <div class="space-y-3">
        {% for notification in notifications %}
          <div class="bg-white border border-gray-200 rounded-lg p-4 {% if not notification.read %}border-l-4 border-l-blue-500{% endif %}">
            <div class="flex items-start gap-4">
              <div class="w-10 h-10 rounded-full border-2 border-gray-300 flex items-center justify-center flex-shrink-0">
                <div class="w-6 h-6 rounded-full bg-gray-200"></div>
              </div>
              <div class="flex-1">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex-1">
                    <p class="text-gray-800">
                      <span class="font-semibold">{{ notification.from_user.username }}</span>
                      {{ notification.message }}
                    </p>
                    <p class="text-gray-500 text-sm mt-1">
                      {{ notification.created_at.strftime('%d/%m/%Y às %H:%M') if notification.created_at else '' }}
                    </p>
                    {% if notification.post %}
                      <a 
                        href="{{ url_for('feed') }}#post-{{ notification.post.id }}" 
                        class="text-blue-600 hover:text-blue-800 text-sm mt-2 inline-block"
                      >
                        Ver post →
                      </a>
                    {% endif %}
                  </div>
                  {% if not notification.read %}
                    <form method="POST" action="{{ url_for('mark_notification_read', notification_id=notification.id) }}" class="inline">
                      <button
                        type="submit"
                        class="text-gray-400 hover:text-gray-600 transition-colors"
                        title="Marcar como lida"
                      >
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <circle cx="12" cy="12" r="10"></circle>
                        </svg>
                      </button>
                    </form>
                  {% else %}
                    <div class="text-green-500" title="Lida">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                      </svg>
                    </div>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="bg-white border border-gray-200 rounded-lg p-12 text-center">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="mx-auto text-gray-400 mb-4">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        </svg>
        <p class="text-gray-500 text-lg mb-2">Não há notificações</p>
        <p class="text-gray-400">Quando alguém interagir com os seus posts, verá notificações aqui.</p>
      </div>
    {% endif %}
  </div>
{% endblock %}

